function qujian(e,t){var a=/^\d{4}-\d{2}/;if(!a.test(e)||!a.test(t))return alert("请输入正确格式的日期，如2013-04-01"),{zhengnian:0,startyear_monthnum:"1",endyear_monthnum:"12",startyear:(new Date).getFullYear()};var s=e.substr(0,4),l=t.substr(0,4),d=e.substr(5,2),i=t.substr(5,2);return{zhengnian:parseInt(l-s-1),startyear_monthnum:parseInt(d),endyear_monthnum:parseInt(i),startyear:parseInt(s)}}!function(){function e(e,t,a,s,l,d){var i=0==e||6==e?"weekend":"";return d&&l&&parseInt(d)>parseInt(l.replace("-","").replace("-",""))&&(i+=(i?" ":"")+"disabled"),t&&t.indexOf(e)!=-1&&(i+=(i?" ":"")+"disabled"),a||(i+=(i?" ":"")+"empty"),a&&s&&i.indexOf("disabled")==-1&&s.indexOf(","+l+",")!=-1&&(i+=(i?" ":"")+"selected"),""==i?"":' class="'+i+'"'}function t(t,a,s,l,d,i){var n=new Date(t,a-1,1),r='<table bordercolor="black" border="1" cellspacing="0" cellpadding="0"'+(s?' class="right"':"")+'><tr><th colspan="8" class="head">'+t+"年"+a+'月</th></tr><tr><th class="selectRowColDate">+</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th></tr><tr><th></th><th class="weekend">日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th class="weekend">六</th></tr>',c=a-1,h=n.getDay(),o=!1;r+='<tr><td class="selectRowDate">→</td>';for(var f=0;f<7;f++)h==f||o?(r+="<td"+e(f,l,!0,d,t+"-"+a+"-"+(n.getDate()<10?"0"+n.getDate():n.getDate()),i)+">"+(n.getDate()<10?"0"+n.getDate():n.getDate())+"</td>",n.setDate(n.getDate()+1),o=!0):r+="<td"+e(f,l,!1)+">&nbsp;</td>";r+="</tr>";for(var f=0;f<5;f++){r+='<tr><td class="selectRowDate">→</td>';for(var u=0;u<7;u++)r+="<td"+e(u,l,n.getMonth()==c,d,t+"-"+a+"-"+(n.getDate()<10?"0"+n.getDate():n.getDate()),i)+">"+(n.getMonth()==c?n.getDate()<10?"0"+n.getDate():n.getDate():"&nbsp;")+"</td>",n.setDate(n.getDate()+1);r+="</tr>"}return r+"</table>"+(s?"<br>":"")}function a(e){return e.parentNode.parentNode.rows[0].cells[0].innerHTML.replace(/[年月]/g,"-")+e.innerHTML}function s(e,s,l,d,i,n,r){s.find("td").unbind();for(var c="",h=(new Date).format("yyyyMMdd"),o=","+d.join(",")+",",i=i||12,n=n||1,r=r||!1,f=n;f<=i;f++)f<10?f="0"+f:f,c+=t(e,f,!1,l,o,r?h:null);s.find("div.picker").append(c).find("td").click(function(){/disabled|empty/g.test(this.className)||$(this).toggleClass("selected"),this.className.indexOf("empty")==-1&&"function"==typeof s.data("config").cellClick&&s.data("config").cellClick(a(this),this.className.indexOf("disabled")!=-1)})}Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e},$.fn.fullYearPicker=function(e,t){if("setqujian"===e||"setDisabledDay"===e||"setYear"===e||"getSelected"===e||"acceptChange"===e||"setColors"===e||"above_disable"===e){var l=$(this);if("setYear"==e)l.data("config").year=t,l.find("div.year a:first").trigger("click",!0);else{if("getSelected"==e)return l.find("td.selected").map(function(){return a(this)}).get();if("acceptChange"==e)l.data("config").value=l.fullYearPicker("getSelected");else{if("setColors"==e)return l.find("td").each(function(){for(var e=a(this),s=0;s<t.dc.length;s++)e==t.dc[s].d&&(this.style.backgroundColor=t.dc[s].c||t.defaultColor||"#f00",$(this).addClass("disabled").attr("title",t.dc[s].title||""))});"setqujian"==e?(l.data("config").startmonth=t.star,l.data("config").endmonth=t.end,l.html(""),l.fullYearPicker({disabledDay:l.data("config").disabledDay,value:l.data("config").value,startmonth:t.start,endmonth:t.end,yearScale:l.data("config").yearScale,cellClick:l.data("config").cellClick,predisabled:!0})):"setDisabledDay"==e?(l.data("config").disabledDay=t,t&&l.find("table tr:gt(1)").find("td").each(function(){t.indexOf(this.cellIndex)!=-1&&(this.className=(this.className||"").replace("selected","")+(this.className?" ":"")+"disabled")})):(l.find("td.disabled").removeClass("disabled"),l.data("config").disabledDay=t,t&&l.find("table tr:gt(1)").find("td").each(function(){t.indexOf(this.cellIndex)!=-1&&(this.className=(this.className||"").replace("selected","")+(this.className?" ":"")+"disabled")}))}}return this}return e=$.extend({year:(new Date).getFullYear(),disabledDay:"",value:[],predisabled:!1},e),this.addClass("fullYearPicker").each(function(){var t=$(this),a=e.year||(new Date).getFullYear(),l={cellClick:e.cellClick,disabledDay:e.disabledDay,year:a,value:e.value,yearScale:e.yearScale,startmonth:e.startmonth,endmonth:e.endmonth,predisabled:e.predisabled};t.data("config",l);var d="";if(l.yearScale){d="<select>";for(var i=l.yearScale.min,n=l.yearScale.max;i<n;i++)d+='<option value="'+i+'"'+(i==a?" selected":"")+">"+i+"</option>";d+="</select>"}d=d||a,t.append('<div class="picker"></div>'),t.find("a").click(function(e,d){return d?a=t.data("config").year:"上一年"==this.innerHTML?a--:a++,t.find("select").val(a),t.find("div.picker").html(""),s(a,$(this).closest("div.fullYearPicker"),l.disabledDay,l.value),this.parentNode.firstChild.nextSibling.data=a+"年",!1}).end().find("select").change(function(){t.fullYearPicker("setYear",this.value)});var r=qujian(l.startmonth,l.endmonth),c=r.startyear_monthnum;if(r.zhengnian<0)s(r.startyear,t,l.disabledDay,l.value,r.endyear_monthnum,c,l.predisabled);else if(r.zhengnian>=0){s(r.startyear,t,l.disabledDay,l.value,12,c,l.predisabled);for(var n=1;n<r.zhengnian+1;n++)s(r.startyear+n,t,l.disabledDay,l.value,12,1,l.predisabled);s(r.startyear+r.zhengnian+1,t,l.disabledDay,l.value,r.endyear_monthnum,1,l.predisabled)}})}}(),$(document).on("click",".selectRowColDate",function(){var e=$(this).parents("table"),t=0,a=0;e.find("td").each(function(){return!!($(this).hasClass("selectRowDate")||$(this).hasClass("empty")||$(this).hasClass("disabled"))||(a++,void($(this).hasClass("selected")?t++:$(this).addClass("selected")))}),a==t&&$(this).data("status","selected_all"),e.find("td.selected").length==a&&"selected_all"==$(this).data("status")?(e.find("td").removeClass("selected"),$(this).data("status","selected_no")):$(this).data("status","selected_all")}),$(document).on("click",".selectColDate",function(){var e=$(this).parent().find("th").index($(this)[0])+1,t=0,a=0,s=$(this).parents("table");s.find("tr td:nth-child("+e+")").each(function(){return!!($(this).hasClass("selectColDate")||$(this).hasClass("empty")||$(this).hasClass("disabled"))||(a++,void($(this).hasClass("selected")?t++:$(this).addClass("selected")))}),a==t&&$(this).data("status","selected_all"),a==t&&"selected_all"==$(this).data("status")?(s.find("tr td:nth-child("+e+")").removeClass("selected"),$(this).data("status","selected_no")):$(this).data("status","selected_all")}),$(document).on("click",".selectRowDate",function(){var e=0,t=0,a=$(this).parent();$(this).removeClass("selected"),a.find("td").each(function(){return!!($(this).hasClass("selectRowDate")||$(this).hasClass("empty")||$(this).hasClass("disabled"))||(t++,void($(this).hasClass("selected")?e++:$(this).addClass("selected")))}),e==t&&$(this).data("status","selected_all"),t==e&&"selected_all"==$(this).data("status")?(a.find("td").removeClass("selected"),$(this).data("status","selected_no")):$(this).data("status","selected_all")});