function qujian(e,t){var a=/^\d{4}-\d{2}/;if(!a.test(e)||!a.test(t))return alert("请输入正确格式的日期，如2013-04-01"),{zhengnian:0,startyear_monthnum:"1",endyear_monthnum:"12",startyear:(new Date).getFullYear()};var s=e.substr(0,4),l=t.substr(0,4),d=e.substr(5,2),i=t.substr(5,2);return{zhengnian:parseInt(l-s-1),startyear_monthnum:parseInt(d),endyear_monthnum:parseInt(i),startyear:parseInt(s)}}!function(){function e(e){var t=/^\d{4}-\d{2}-\d{2}/;if(t.test(e))return parseInt(e.replace("-","").replace("-",""))}function t(t,a,s,l,d,i,n,r){var c=0==t||6==t?"weekend":"";return(i||n)&&d&&(e(d)<e(i)&&(c+=(c?" ":"")+"disabled"),e(d)>e(n)&&(c+=(c?" ":"")+"disabled")),a&&a.indexOf(t)!=-1&&(c+=(c?" ":"")+"disabled"),s||(c+=(c?" ":"")+"empty"),s&&l&&l.indexOf(","+d+",")!=-1&&(c.indexOf("disabled")==-1&&(c+=(c?" ":"")+"selected"),"user"==r&&c.indexOf("selected")==-1&&(c+=(c?" ":"")+"selected")),""==c?"":' class="'+c+'"'}function a(e,a,s,l,d,i,n,r){var c=new Date(e,a-1,1),h='<table bordercolor="black" border="1" cellspacing="0" cellpadding="0"'+(s?' class="right"':"")+'><tr><th colspan="8" class="head">'+e+"年"+a+'月</th></tr><tr><th class="selectRowColDate">+</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th><th class="selectColDate">↓</th></tr><tr><th></th><th class="weekend">日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th class="weekend">六</th></tr>',o=a-1,f=c.getDay(),u=!1;h+='<tr><td class="selectRowDate">→</td>';for(var g=0;g<7;g++)f==g||u?(h+="<td"+t(g,l,!0,d,e+"-"+a+"-"+(c.getDate()<10?"0"+c.getDate():c.getDate()),i,n,r)+">"+(c.getDate()<10?"0"+c.getDate():c.getDate())+"</td>",c.setDate(c.getDate()+1),u=!0):h+="<td"+t(g,l,!1)+">&nbsp;</td>";h+="</tr>";for(var g=0;g<5;g++){h+='<tr><td class="selectRowDate">→</td>';for(var _=0;_<7;_++)h+="<td"+t(_,l,c.getMonth()==o,d,e+"-"+a+"-"+(c.getDate()<10?"0"+c.getDate():c.getDate()),i,n,r)+">"+(c.getMonth()==o?c.getDate()<10?"0"+c.getDate():c.getDate():"&nbsp;")+"</td>",c.setDate(c.getDate()+1);h+="</tr>"}return h+"</table>"+(s?"<br>":"")}function s(e){return e.parentNode.parentNode.rows[0].cells[0].innerHTML.replace(/[年月]/g,"-")+e.innerHTML}function l(e,t,l,d,i,n,r,c,h){t.find("td").unbind();for(var o="",f=","+d.join(",")+",",i=i||12,n=n||1,u=n;u<=i;u++)u<10?u="0"+u:u,o+=a(e,u,!1,l,f,r,c,h);t.find("div.picker").append(o).find("td").click(function(){/disabled|empty/g.test(this.className)||$(this).toggleClass("selected"),this.className.indexOf("empty")==-1&&"function"==typeof t.data("config").cellClick&&t.data("config").cellClick(s(this),this.className.indexOf("disabled")!=-1)})}Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e},$.fn.fullYearPicker=function(e,t){if("setqujian"===e||"setDisabledDay"===e||"setYear"===e||"getSelected"===e||"acceptChange"===e||"setColors"===e||"above_disable"===e){var a=$(this);if("setYear"==e)a.data("config").year=t,a.find("div.year a:first").trigger("click",!0);else{if("getSelected"==e)return a.find("td.selected").map(function(){return s(this)}).get();if("acceptChange"==e)a.data("config").value=a.fullYearPicker("getSelected");else{if("setColors"==e)return a.find("td").each(function(){for(var e=s(this),a=0;a<t.dc.length;a++)e==t.dc[a].d&&(this.style.backgroundColor=t.dc[a].c||t.defaultColor||"#f00",$(this).addClass("disabled").attr("title",t.dc[a].title||""))});"setqujian"==e?(a.data("config").startmonth=t.star,a.data("config").endmonth=t.end,a.html(""),a.fullYearPicker({disabledDay:a.data("config").disabledDay,value:a.data("config").value,startmonth:t.start,endmonth:t.end,yearScale:a.data("config").yearScale,cellClick:a.data("config").cellClick})):"setDisabledDay"==e?(a.data("config").disabledDay=t,t&&a.find("table tr:gt(1)").find("td").each(function(){t.indexOf(this.cellIndex)!=-1&&(this.className=(this.className||"").replace("selected","")+(this.className?" ":"")+"disabled")})):(a.find("td.disabled").removeClass("disabled"),a.data("config").disabledDay=t,t&&a.find("table tr:gt(1)").find("td").each(function(){t.indexOf(this.cellIndex)!=-1&&(this.className=(this.className||"").replace("selected","")+(this.className?" ":"")+"disabled")}))}}return this}return e=$.extend({year:(new Date).getFullYear(),disabledDay:"",value:[],pre_date_dis:!1,aft_date_dis:!1},e),this.addClass("fullYearPicker").each(function(){var t=$(this),a=e.year||(new Date).getFullYear(),s={cellClick:e.cellClick,disabledDay:e.disabledDay,year:a,value:e.value,yearScale:e.yearScale,startmonth:e.startmonth,endmonth:e.endmonth,pre_date_dis:e.pre_date_dis,aft_date_dis:e.aft_date_dis,roll_play:e.roll_play};t.data("config",s);var d="";if(s.yearScale){d="<select>";for(var i=s.yearScale.min,n=s.yearScale.max;i<n;i++)d+='<option value="'+i+'"'+(i==a?" selected":"")+">"+i+"</option>";d+="</select>"}d=d||a,t.append('<div class="picker"></div>'),t.find("a").click(function(e,d){return d?a=t.data("config").year:"上一年"==this.innerHTML?a--:a++,t.find("select").val(a),t.find("div.picker").html(""),l(a,$(this).closest("div.fullYearPicker"),s.disabledDay,s.value),this.parentNode.firstChild.nextSibling.data=a+"年",!1}).end().find("select").change(function(){t.fullYearPicker("setYear",this.value)});var r=qujian(s.startmonth,s.endmonth),c=r.startyear_monthnum;if(r.zhengnian<0)l(r.startyear,t,s.disabledDay,s.value,r.endyear_monthnum,c,s.pre_date_dis?s.pre_date_dis:void 0,s.aft_date_dis?s.aft_date_dis:void 0,s.roll_play);else if(r.zhengnian>=0){l(r.startyear,t,s.disabledDay,s.value,12,c,s.pre_date_dis?s.pre_date_dis:void 0,s.aft_date_dis?s.aft_date_dis:void 0,s.roll_play);for(var n=1;n<r.zhengnian+1;n++)l(r.startyear+n,t,s.disabledDay,s.value,12,1,s.pre_date_dis?s.pre_date_dis:void 0,s.aft_date_dis?s.aft_date_dis:void 0,s.roll_play);l(r.startyear+r.zhengnian+1,t,s.disabledDay,s.value,r.endyear_monthnum,1,s.pre_date_dis?s.pre_date_dis:void 0,s.aft_date_dis?s.aft_date_dis:void 0,s.roll_play)}})}}(),$(document).on("click",".selectRowColDate",function(){var e=$(this).parents("table"),t=0,a=0;e.find("td").each(function(){return!!($(this).hasClass("selectRowDate")||$(this).hasClass("empty")||$(this).hasClass("disabled"))||(a++,void($(this).hasClass("selected")?t++:$(this).addClass("selected")))}),a==t&&$(this).data("status","selected_all"),t==a&&"selected_all"==$(this).data("status")?(e.find("td").each(function(){return!(!$(this).hasClass("selected")||!$(this).hasClass("disabled"))||void $(this).removeClass("selected")}),$(this).data("status","selected_no")):$(this).data("status","selected_all")}),$(document).on("click",".selectColDate",function(){var e=$(this).parent().find("th").index($(this)[0])+1,t=0,a=0,s=$(this).parents("table");s.find("tr td:nth-child("+e+")").each(function(){return!!($(this).hasClass("selectColDate")||$(this).hasClass("empty")||$(this).hasClass("disabled"))||(a++,void($(this).hasClass("selected")?t++:$(this).addClass("selected")))}),a==t&&$(this).data("status","selected_all"),a==t&&"selected_all"==$(this).data("status")?(s.find("tr td:nth-child("+e+")").each(function(){return!(!$(this).hasClass("selected")||!$(this).hasClass("disabled"))||void $(this).removeClass("selected")}),$(this).data("status","selected_no")):$(this).data("status","selected_all")}),$(document).on("click",".selectRowDate",function(){var e=0,t=0,a=$(this).parent();$(this).removeClass("selected"),a.find("td").each(function(){return!!($(this).hasClass("selectRowDate")||$(this).hasClass("empty")||$(this).hasClass("disabled"))||(t++,void($(this).hasClass("selected")?e++:$(this).addClass("selected")))}),e==t&&$(this).data("status","selected_all"),t==e&&"selected_all"==$(this).data("status")?(a.find("td").each(function(){return!(!$(this).hasClass("selected")||!$(this).hasClass("disabled"))||void $(this).removeClass("selected")}),$(this).data("status","selected_no")):$(this).data("status","selected_all")});